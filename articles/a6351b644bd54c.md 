---
title: "svelte/sapperã§sitemapã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•"
emoji: "ğŸ‘»"
type: "tech"
topics: ["svelte", "sapper", "sitemap"]
published: true
---

# ã¯ã˜ã‚ã«
sapperã§sitemap.xmlã‚’ç”Ÿæˆã™ã‚‹æ–¹æ³•ã§å°‘ã—æ™‚é–“ãŒã‹ã‹ã£ãŸã®ã§ã€ã¾ã¨ã‚ã¦ãŠãã¾ã™ã€‚

## å¯¾è±¡
- sapperã§sitemapã‚’è‡ªå‹•ç”Ÿæˆã—ãŸã„äºº
- svelteKitã®ãƒªãƒªãƒ¼ã‚¹ã‚’å¾…ã¦ãšã€sapperã‚’ä½¿ã„ãŸã„äºº

## å‚è€ƒè³‡æ–™
åŸºæœ¬çš„ã«ã¯ã“ã¡ã‚‰ã®issueã‚’èª­ã‚“ã§ã„ã‘ã°ã€ã§ãã¾ã™ã€‚
ã‚½ãƒ¼ã‚¹ãŒæ•£ã‚‰ã°ã£ã¦ã„ã‚‹ã®ã¨ã€ãƒ–ãƒ­ã‚°åˆ©ç”¨ãŒãƒ¡ã‚¤ãƒ³ã®è©±ãŒå¤šã‹ã£ãŸã®ã§ã€ä»Šå›è¨˜äº‹åŒ–ã—ã¾ã—ãŸã€‚
https://github.com/sveltejs/sapper/issues/461

# sitemapã®ç”Ÿæˆ
æœ¬é¡Œã€routes/sitemap.xml.jsã‚’ä½œæˆã—ã€ä»¥ä¸‹ã‚’è¨˜è¿°ã—ã¾ã™ã€‚

lastmodã¯å¤‰æ›´ã™ã‚‹ãŸã³ (ã‚µã‚¤ãƒˆã‚’ä¿®æ­£ã™ã‚‹ãŸã³) æ›´æ–°ã—ãŸã‹ã£ãŸã®ã§ã€``<lastmod>${new Date().toISOString()}</lastmod>``ã¨ã—ã¾ã—ãŸã€‚

URL (pages) ã¯å›ºå®šãªã‚‰é…åˆ—ã§ã€ãŸãã•ã‚“å¢—ãˆã‚‹ãªã‚‰é©å½“ã«mapã§å‡¦ç†ã—ã¦ã‚„ã‚Šã¾ã™ã€‚
ãƒ–ãƒ­ã‚°ãªã©ã®ãŸãã•ã‚“å¢—ãˆã‚‹ã‚¿ã‚¤ãƒ—ã¯ä¸Šè¨˜issueãŒè©³ã—ã‚ã§ã™ã€‚

```js
// routes/sitemap.xml.js

const pages = [
  '',
  '/main',
]

const render = () => `
<?xml version="1.0" encoding="UTF-8" ?>
<urlset xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://www.sitemaps.org/schemas/sitemap/0.9" xsi:schemaLocation="http://www.sitemaps.org/schemas/sitemap/0.9 http://www.sitemaps.org/schemas/sitemap/0.9/sitemap.xsd">
  <url>
    <loc>https://<è‡ªåˆ†ã®ã‚µã‚¤ãƒˆ>/</loc>
    <priority>1.0</priority>
    <lastmod>${new Date().toISOString()}</lastmod>
  </url>
  <url>
    <loc>https://<è‡ªåˆ†ã®ã‚µã‚¤ãƒˆ>/main</loc>
  </url>
</urlset>
`;

export function get(req, res) {
  res.setHeader('Cache-Control', `max-age=0, s-max-age=${600}`);
  res.setHeader('Content-Type', 'application/xml');

  const sitemap = render(pages);
  res.end(sitemap);
}
```

index.svelteã«ä»¥ä¸‹ã‚’è¿½è¨˜ã—ã¦ãŠãã¾ã™ã€‚

```svelte
// index.svelte
<script> ... </script>
<script context="module">
	export function preload({}) {
		return this.fetch('sitemap.xml')
	}
</script>
```

ã‚ã¨ã¯ã€export (``yarn export``) ã™ã‚‹ã ã‘ã§ã™ã€‚

```package.json
...
"scripts": {
  ...
  "export": "sapper export --legacy --entry '/ /main'"
  ...
}
```

exportå¾Œã€__sapper__/export/sitemap.xmlã®ç”Ÿæˆã‚’ç¢ºèªã§ãã¾ã™ã€‚
